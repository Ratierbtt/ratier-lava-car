<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ratier Lava Car</title>
<style>
body{margin:0;font-family:Arial,Helvetica,sans-serif;background:#f1f5f9}
header{background:#0f172a;color:#fff;padding:15px;text-align:center;font-size:20px;font-weight:bold}
section{padding:15px;display:none}
section.ativa{display:block}
.card{background:#fff;border-radius:16px;padding:18px;margin-bottom:15px;box-shadow:0 6px 14px rgba(0,0,0,.08)}
input,select,button{width:100%;padding:12px;margin-top:10px;border-radius:10px;border:1px solid #ccc;font-size:16px}
button{background:#0f172a;color:#fff;border:none}
.menu{position:fixed;bottom:0;left:0;right:0;display:flex;background:#fff;border-top:1px solid #ddd}
.menu button{flex:1;background:none;color:#0f172a;font-weight:bold;padding:14px}
.total{font-size:20px;font-weight:bold;margin-top:10px;text-align:center}

</style>
</head>
<body>
<header>Ratier Lava Car</header>

<section id="lavagens" class="ativa">
<div class="card">
<h3>Nova Lavagem</h3>
<label><input type="checkbox" value="Fora"> Fora</label><br>
<label><input type="checkbox" value="Dentro"> Dentro</label><br>
<label><input type="checkbox" value="Embaixo"> Embaixo</label><br>
<label><input type="checkbox" value="Motor"> Motor</label>
<input type="number" id="valorLavagem" placeholder="Valor cobrado">
<select id="pagamento">
<option>Dinheiro</option>
<option>Pix</option>
<option>Cartão</option>
</select>
<button onclick="salvarLavagem()">Salvar Lavagem</button>
</div>
<div class="card total" id="totalHoje">Total hoje: R$ 0</div>
</section>

<section id="despesas">
<div class="card">
<h3>Nova Despesa</h3>
<input id="descDespesa" placeholder="Descrição">
<input type="number" id="valorDespesa" placeholder="Valor">
<button onclick="salvarDespesa()">Salvar Despesa</button>
</div>
</section>

<section id="fechamento">
<div class="card">
<h3>Fechamento</h3>
<input type="date" id="dataInicio">
<input type="date" id="dataFim">
<button onclick="calcular()">Calcular</button>
<p id="resultado"></p>
<button onclick="gerarPDF()">Gerar PDF</button>
</div>
</section>

<div class="menu">
<button onclick="abrir('lavagens')">Lavagens</button>
<button onclick="abrir('despesas')">Despesas</button>
<button onclick="abrir('fechamento')">Fechamento</button>
</div>

<script>
let lavagens = JSON.parse(localStorage.getItem('lavagens')) || [];
let despesas = JSON.parse(localStorage.getItem('despesas')) || [];

function abrir(id) {
  document.querySelectorAll('section').forEach(s => s.classList.remove('ativa'));
  document.getElementById(id).classList.add('ativa');
}

function salvarLavagem() {
  const valor = Number(document.getElementById('valorLavagem').value);
  const pagamento = document.getElementById('pagamento').value;

  if (!valor) {
    alert('Informe o valor');
    return;
  }

  const data = new Date().toISOString().split('T')[0];
  lavagens.push({ data, valor, pagamento });
  localStorage.setItem('lavagens', JSON.stringify(lavagens));

  document.getElementById('valorLavagem').value = '';
  
  atualizarHoje();
}



function atualizarHoje() {
  const hoje = new Date().toISOString().split('T')[0];
  const total = lavagens
    .filter(l => l.data === hoje)
    .reduce((s, l) => s + l.valor, 0);

  document.getElementById('totalHoje').innerText = 'Total hoje: R$ ' + total.toFixed(2);
}

function salvarDespesa() {
  const v = Number(document.getElementById('valorDespesa').value);
  if (!v) {
    alert('Informe valor');
    return;
  }

  despesas.push({ valor: v });
  localStorage.setItem('despesas', JSON.stringify(despesas));

  document.getElementById('valorDespesa').value = '';
  document.getElementById('descDespesa').value = '';
}

function calcular() {
  const i = document.getElementById('dataInicio').value;
  const f = document.getElementById('dataFim').value;

  const tl = lavagens
    .filter(l => (!i || l.data >= i) && (!f || l.data <= f))
    .reduce((s, l) => s + l.valor, 0);

  const td = despesas.reduce((s, d) => s + d.valor, 0);

  document.getElementById('resultado').innerText = `Lavagens: R$ ${tl.toFixed(2)} | Despesas: R$ ${td.toFixed(2)} | Lucro: R$ ${(tl - td).toFixed(2)}`;
}

function gerarPDF() {
  const i = document.getElementById('dataInicio').value;
  const f = document.getElementById('dataFim').value;

  if (!i || !f) {
    alert('Selecione o intervalo de datas');
    return;
  }

  const lav = lavagens.filter(l => l.data >= i && l.data <= f);
  const totalLav = lav.reduce((s,l)=>s+l.valor,0);
  const totalDesp = despesas.reduce((s,d)=>s+d.valor,0);

  const w = window.open('', '_blank');
  w.document.write(`
    <html><head><title>Fechamento Ratier Lava Car</title>
    <style>
      body{font-family:Arial;padding:20px}
      h1{text-align:center}
      table{width:100%;border-collapse:collapse;margin-top:20px}
      th,td{border:1px solid #ccc;padding:8px;text-align:left}
    </style>
    </head><body>
    <h1>Ratier Lava Car</h1>
    <p>Av. Francisco Fernandes Filho Nº84<br>Iguatemi - MS</p>
    <p><strong>Período:</strong> ${i} até ${f}</p>
    <table>
      <tr><th>Data</th><th>Valor</th><th>Pagamento</th></tr>
      ${lav.map(l=>`<tr><td>${l.data}</td><td>R$ ${l.valor.toFixed(2)}</td><td>${l.pagamento}</td></tr>`).join('')}
    </table>
    <h3>Total Lavagens: R$ ${totalLav.toFixed(2)}</h3>
    <h3>Total Despesas: R$ ${totalDesp.toFixed(2)}</h3>
    <h2>Lucro: R$ ${(totalLav-totalDesp).toFixed(2)}</h2>
    </body></html>
  `);
  w.document.close();
  w.print();
}

atualizarHoje();
</script>
</body>
</html>
